import{s as N}from"./index-CjO01vaA.js";import{_ as B,r as y,k as U,w as O,o as f,a as e,c as h,e as C,t as i,d as F,F as I,l as z,v as M}from"./index-CNRQAAaJ.js";import{a as g}from"./axios-DsPaXkF5.js";const T={setup(){const u=y([]),_=y([]),x=y(""),d=async(t,o,a)=>{const c=t.target.files[0];if(c){const s=new FileReader;s.onload=async p=>{u.value[o][a]=p.target.result;const D=new FormData;D.append("file",c);try{if((await g.post("/api/check-font",D,{headers:{"Content-Type":"multipart/form-data"}})).data.isFont)if(a=="front"){const b=await g.post("/api/process-upload",D,{headers:{"Content-Type":"multipart/form-data"}});b.data.status==="success"?l(b.data.detections[0].message,o):b.data.status==="warning"&&l(b.data.new_data,o)}else console.log("sao lại đưa mặt trước vào ô này?????")}catch(k){console.error("Error uploading file:",k)}},s.readAsDataURL(c)}},v=(t,o)=>t===o?'<span class="text-green-500">Match</span>':'<span class="text-red-500">Not Match</span>',w=t=>{const{insured:o,buyer:a,dependents:c}=t;u.value=[{...o,type:"Insured",front:null,back:null},{...a,type:"Buyer",front:null,back:null},...c.map(s=>({...s,type:"Dependent",front:null,back:null}))],_.value=u.value.map(s=>{var p;return{NationalID:{oldData:s.nationalID,newData:""},CitizenID:{oldData:s.citizenID,newData:""},DateOfBirth:{oldData:m(s.dateOfBirth),newData:""},FullName:{oldData:s.fullName,newData:""},Address:{oldData:s.address,newData:""},Gender:{oldData:((p=s.gender)==null?void 0:p.name)||"",newData:""}}})},m=t=>{if(!t||t.length!==8)return t;const o=t.slice(0,2),a=t.slice(2,4),c=t.slice(4);return`${o}/${a}/${c}`},l=(t,o)=>{var s,p;console.log("Updated Data:",t);const a=u.value[o],c={NationalID:{oldData:a.nationalID,newData:t.id_identity_card||a.nationalID},CitizenID:{oldData:a.citizenID,newData:t.id_passport||a.citizenID},DateOfBirth:{oldData:a.dateOfBirth,newData:m(t.birth_date)||a.dateOfBirth},FullName:{oldData:a.fullName,newData:t.fullname||a.fullName},Address:{oldData:a.address,newData:t.address||a.address},Gender:{oldData:((s=a.gender)==null?void 0:s.name)||"",newData:t.gender||((p=a.gender)==null?void 0:p.name)||""}};_.value[o]=c},r=async t=>{try{if(t===null||t==="")console.warn("Không tìm thấy mã thụ lý.");else{const o=await g.get(`/v4/api/fortest/${t}`);w(o.data)}}catch(o){console.error("Failed to load buyer:",o)}},n=sessionStorage.getItem("CMI_ID");return!n||n==""||r(n),{people:u,comparisonData:_,notes:x,handleUpload:d,compareFields:v}}},j={class:"flex flex-col gap-8"},A={class:"card flex-1 flex flex-col gap-4 p-4"},L={class:"font-semibold text-xl"},R={class:"font-semibold text-xl"},V={class:"grid grid-cols-2 gap-4"},E={class:"flex flex-col gap-2"},G=["for"],H=["id","onChange"],K={class:"flex flex-col gap-2"},W=["for"],$=["id","onChange"],q={class:"flex items-center justify-center"},J={key:0,class:"w-full h-auto"},P=["src"],Q={class:"flex items-center justify-center"},X={key:0,class:"w-full h-auto"},Y=["src"],Z={class:"card flex-1 flex flex-col gap-4 p-4"},S={class:"font-semibold text-xl"},ee={class:"min-w-full mt-4 border-separate border-spacing-2 border border-gray-300"},te=e("thead",null,[e("tr",null,[e("th",{class:"border border-gray-400 px-4 py-2"},"Field"),e("th",{class:"border border-gray-400 px-4 py-2"},"Old Data"),e("th",{class:"border border-gray-400 px-4 py-2"},"New Data"),e("th",{class:"border border-gray-400 px-4 py-2"},"Comparison")])],-1),ae={class:"border border-gray-300 px-4 py-2"},oe={class:"border border-gray-300 px-4 py-2"},se={class:"border border-gray-300 px-4 py-2"},le=["innerHTML"],re={class:"card flex flex-col gap-4 p-4"},ne=e("div",{class:"font-semibold text-xl"},"Notes",-1),de={class:"flex flex-col gap-2"},ce=e("label",{for:"notes",class:"font-medium"},"Notes",-1);function ie(u,_,x,d,v,w){const m=N;return f(),U(m,null,{default:O(()=>[e("div",j,[(f(!0),h(I,null,C(d.people,(l,r)=>(f(),h("div",{key:r,class:"flex flex-col md:flex-row gap-8 mb-8"},[e("div",A,[e("div",L,i(r+1)+". Upload ID Cards for "+i(l.type),1),e("div",R,i(l.fullName),1),e("div",V,[e("div",E,[e("label",{for:"front-upload-"+r,class:"font-medium"},"Upload Front Side",8,G),e("input",{id:"front-upload-"+r,type:"file",accept:"image/*",onChange:n=>d.handleUpload(n,r,"front"),class:"border rounded p-2"},null,40,H)]),e("div",K,[e("label",{for:"back-upload-"+r,class:"font-medium"},"Upload Back Side",8,W),e("input",{id:"back-upload-"+r,type:"file",accept:"image/*",onChange:n=>d.handleUpload(n,r,"back"),class:"border rounded p-2"},null,40,$)]),e("div",q,[l.front?(f(),h("div",J,[e("img",{src:l.front,width:"250",class:"object-cover border rounded"},null,8,P)])):F("",!0)]),e("div",Q,[l.back?(f(),h("div",X,[e("img",{src:l.back,width:"250",class:"object-cover border rounded"},null,8,Y)])):F("",!0)])])]),e("div",Z,[e("div",S,"Compare Data for "+i(l.type)+" "+i(r+1),1),e("table",ee,[te,e("tbody",null,[(f(!0),h(I,null,C(d.comparisonData[r],(n,t)=>(f(),h("tr",{key:t},[e("td",ae,i(t),1),e("td",oe,i(n.oldData),1),e("td",se,i(n.newData),1),e("td",{class:"border border-gray-300 px-4 py-2",innerHTML:d.compareFields(n.oldData,n.newData)},null,8,le)]))),128))])])])]))),128)),e("div",re,[ne,e("div",de,[ce,z(e("textarea",{id:"notes",rows:"6","onUpdate:modelValue":_[0]||(_[0]=l=>d.notes=l),placeholder:"Add any additional notes here",class:"border rounded p-2"},null,512),[[M,d.notes]])])])])]),_:1})}const _e=B(T,[["render",ie]]);export{_e as default};
